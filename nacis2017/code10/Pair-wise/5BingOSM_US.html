<!DOCTYPE html> 
<html> 
<head> 
 
<script type="text/javascript" src="http://dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script>
<script src="http://www.openlayers.org/api/OpenLayers.js"></script>

<script type="text/javascript"> 

function initialize() { 
  
// set the box
  var slat = 30.367988;
  var nlat = 49.242429;
  var wlong = -123.002797;
  var elong = -66.401444;

// find the difference in each direction
  var lngSpan = wlong - elong; 
  var latSpan = nlat - slat; 

// find the random point within the box
  var lat= slat + latSpan * Math.random();
  var lon= elong + lngSpan * Math.random(); 
  
// OpenStreetMap
    var Map2;
    var zoom = 16;

    var fromProjection = new OpenLayers.Projection("EPSG:4326");   // Transform from WGS 1984
    var toProjection   = new OpenLayers.Projection("EPSG:900913"); // to Spherical Mercator Projection
    var position       = new OpenLayers.LonLat(lon, lat).transform( fromProjection, toProjection);
 
    var map = new OpenLayers.Map("Map2");
    var mapnik = new OpenLayers.Layer.OSM();
    map.addLayer(mapnik);
 
    var markers = new OpenLayers.Layer.Markers( "Markers" );
    map.addLayer(markers);
    markers.addMarker(new OpenLayers.Marker(position));
 
    //map.setCenter(position, zoom);
	map.moveTo(position, zoom);
  
//  alert("starting Bing");
  
  // Bing
         var Map = null;         

//The key in the following line has been issued by Microsoft. It is no longer specific to an individual server.
            Map = new Microsoft.Maps.Map(document.getElementById("myMap"),
                         {credentials:"AmnzJW8uTvn19E0NiZ7Gx5qxrnm_oQB9zKZw2mIJ0kw6D9dPqwivr4_7WGHCZZgh"}); 

          // Define the pushpin location
            var loc = new Microsoft.Maps.Location(lat,lon);
            
          // Add a pin to the map
            var pin = new Microsoft.Maps.Pushpin(loc); 
            Map.entities.push(pin);

          // Center the map on the location
            Map.setView({center: loc, zoom: 16}); 
			//Map.setView({mapTypeId: Microsoft.Maps.MapTypeId.Road});
			
          Map.setView({
            mapTypeId: Microsoft.Maps.MapTypeId.Road,
			//center: Microsoft.Maps.Location(lat, lon),
            zoom: 16
        });  

} 

</script> 
</head> 
<body onLoad="initialize()">
  <div id="myMap" style="width:800px; height:500px; position: absolute; top: 5px; left: 5px; border: thin solid black"></div> 
  <div id="Map2" style="height:500px; width:800px; position: absolute; left: 811px; top: 5px; border: thin solid black"></div>
</body> 
</html>


